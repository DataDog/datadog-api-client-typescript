repos:
  - repo: local
    hooks:
      - id: generate
        name: Generate
        language: node
        entry: make
        files: '^(\.generator/.*|\.pre-commit-config\.yaml|package\.json|yarn\.lock|\.eslintrc\.js|Makefile|\features/.*)'
        pass_filenames: false
      - id: lint
        name: Lint
        language: node
        entry: yarn run lint:fix
        stages: [manual]
        pass_filenames: false
      - id: lint-examples
        name: Lint examples
        language: node
        entry: yarn run lint:fix-examples
        stages: [manual]
        pass_filenames: false
      - id: generator
        name: generator
        language: python
        entry: bash -c "cd .generator && poetry install && poetry run python -m generator ./schemas/v1/openapi.yaml ./schemas/v2/openapi.yaml -o ../packages"
        files: "^.generator/(config|schemas/v1|src|poetry.lock|pyproject.toml)"
        stages: [manual]
        pass_filenames: false
        additional_dependencies:
          - "poetry==1.1.15"
      - id: examples
        name: examples
        language: python
        entry: bash -c "cd .generator && poetry install && poetry run pytest"
        files: "^.generator/"
        stages: [manual]
        pass_filenames: false
        additional_dependencies:
          - "poetry==1.1.15"
