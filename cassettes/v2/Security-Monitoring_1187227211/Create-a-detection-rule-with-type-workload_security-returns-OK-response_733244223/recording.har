{
  "log": {
    "_recordingName": "Security Monitoring/Create a detection rule with type 'workload_security' returns \"OK\" response",
    "creator": {
      "comment": "persister:fs",
      "name": "Polly.JS",
      "version": "5.1.0"
    },
    "entries": [
      {
        "_id": "7dd828addaceac61c54def9ca5836e64",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 573,
          "cookies": [],
          "headers": [
            {
              "_fromType": "array",
              "name": "user-agent",
              "value": "datadog-api-client-typescript/1.0.0-beta.4 (node 14.17.4; os Linux; arch x64)"
            },
            {
              "_fromType": "array",
              "name": "accept",
              "value": "application/json, */*;q=0.8"
            },
            {
              "_fromType": "array",
              "name": "content-type",
              "value": "application/json"
            },
            {
              "_fromType": "array",
              "name": "x-datadog-parent-id",
              "value": "6698455153852476541"
            },
            {
              "_fromType": "array",
              "name": "x-datadog-trace-id",
              "value": "1792726140053302697"
            },
            {
              "_fromType": "array",
              "name": "content-length",
              "value": "573"
            },
            {
              "_fromType": "array",
              "name": "connection",
              "value": "close"
            },
            {
              "name": "host",
              "value": "api.datadoghq.com"
            }
          ],
          "headersSize": 492,
          "httpVersion": "HTTP/1.1",
          "method": "POST",
          "postData": {
            "mimeType": "application/json",
            "params": [],
            "text": "{\"cases\":[{\"condition\":\"a > 0\",\"name\":\"\",\"notifications\":[],\"status\":\"info\"}],\"filters\":[],\"isEnabled\":true,\"message\":\"Test rule\",\"name\":\"Test-Create_a_detection_rule_with_type_workload_security_returns_OK_response-1629100140\",\"options\":{\"evaluationWindow\":900,\"keepAlive\":3600,\"maxSignalDuration\":86400},\"queries\":[{\"agentRule\":{\"agentRuleId\":\"kernel_module_unlink_2\",\"expression\":\"(open.flags & ((O_CREAT|O_RDWR|O_WRONLY|O_TRUNC)) > 0)\"},\"aggregation\":\"count\",\"distinctFields\":[],\"groupByFields\":[],\"metric\":\"\",\"query\":\"@test:true\"}],\"tags\":[],\"type\":\"workload_security\"}"
          },
          "queryString": [],
          "url": "https://api.datadoghq.com/api/v2/security_monitoring/rules"
        },
        "response": {
          "bodySize": 901,
          "content": {
            "mimeType": "application/json;charset=utf-8",
            "size": 901,
            "text": "{\"creationAuthorId\":1445416,\"tags\":[],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Test rule\",\"options\":{\"detectionMethod\":\"threshold\",\"evaluationWindow\":900,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":1,\"createdAt\":1629100140907,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"metric\":\"\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"@agent.rule_id:(Test_Create_a_detection_rule_with_type_workload_security_returns_OK_response_1629100140_kernel_module_unlink_2 OR kernel_module_unlink_2)\",\"agentRule\":{\"expression\":\"(open.flags & ((O_CREAT|O_RDWR|O_WRONLY|O_TRUNC)) > 0)\",\"agentRuleId\":\"kernel_module_unlink_2\"}}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"workload_security\",\"id\":\"csl-lpm-o3j\",\"isDefault\":false,\"name\":\"Test-Create_a_detection_rule_with_type_workload_security_returns_OK_response-1629100140\"}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "date",
              "value": "Mon, 16 Aug 2021 07:49:00 GMT"
            },
            {
              "name": "content-type",
              "value": "application/json;charset=utf-8"
            },
            {
              "name": "content-length",
              "value": "901"
            },
            {
              "name": "connection",
              "value": "close"
            },
            {
              "name": "vary",
              "value": "Accept-Encoding"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "cache-control",
              "value": "no-cache"
            },
            {
              "name": "x-ratelimit-limit",
              "value": "600"
            },
            {
              "name": "x-ratelimit-period",
              "value": "60"
            },
            {
              "name": "x-ratelimit-reset",
              "value": "60"
            },
            {
              "name": "x-ratelimit-remaining",
              "value": "599"
            },
            {
              "name": "content-disposition",
              "value": "inline"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=15724800;"
            },
            {
              "name": "content-security-policy",
              "value": "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report"
            },
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            }
          ],
          "headersSize": 525,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2021-08-16T07:49:00.468Z",
        "time": 484,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 484
        }
      },
      {
        "_id": "35b23d74fe3d2614af194129d8229540",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "_fromType": "array",
              "name": "user-agent",
              "value": "datadog-api-client-typescript/1.0.0-beta.4 (node 14.17.4; os Linux; arch x64)"
            },
            {
              "_fromType": "array",
              "name": "accept",
              "value": "application/json, */*;q=0.8"
            },
            {
              "_fromType": "array",
              "name": "x-datadog-parent-id",
              "value": "2468041391897675304"
            },
            {
              "_fromType": "array",
              "name": "x-datadog-trace-id",
              "value": "1792726140053302697"
            },
            {
              "_fromType": "array",
              "name": "connection",
              "value": "close"
            },
            {
              "name": "host",
              "value": "api.datadoghq.com"
            }
          ],
          "headersSize": 453,
          "httpVersion": "HTTP/1.1",
          "method": "DELETE",
          "queryString": [],
          "url": "https://api.datadoghq.com/api/v2/security_monitoring/rules/csl-lpm-o3j"
        },
        "response": {
          "bodySize": 0,
          "content": {
            "mimeType": "text/plain",
            "size": 0
          },
          "cookies": [],
          "headers": [
            {
              "name": "date",
              "value": "Mon, 16 Aug 2021 07:49:01 GMT"
            },
            {
              "name": "content-length",
              "value": "0"
            },
            {
              "name": "connection",
              "value": "close"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "cache-control",
              "value": "no-cache"
            },
            {
              "name": "x-ratelimit-limit",
              "value": "600"
            },
            {
              "name": "x-ratelimit-period",
              "value": "60"
            },
            {
              "name": "x-ratelimit-reset",
              "value": "59"
            },
            {
              "name": "x-ratelimit-remaining",
              "value": "598"
            },
            {
              "name": "content-disposition",
              "value": "inline"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=15724800;"
            },
            {
              "name": "content-security-policy",
              "value": "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report"
            },
            {
              "name": "x-frame-options",
              "value": "SAMEORIGIN"
            }
          ],
          "headersSize": 454,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 204,
          "statusText": "No Content"
        },
        "startedDateTime": "2021-08-16T07:49:00.956Z",
        "time": 390,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 390
        }
      }
    ],
    "pages": [],
    "version": "1.2"
  }
}
